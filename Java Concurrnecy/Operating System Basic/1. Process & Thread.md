# 1. Process & Thread

## Process
운영체제로 부터 자원을 할당 받은 최소 작업 단위이며, 프로그램을 실행하여 프로그램 데이터들이 메모리에 올라와 CPU를 할당받아 명령을 수행하고 있는 상태이다. 간단하게 정리하자면 프로그램 데이터들이 메모리에 올라와 실행 중인 프로그램을 프로세스라고 한다.

프로세스가 할당 받은 메모리는 4가지 영역을 가진다.
- code ~ stack으로 갈 수록 높은 주소를 가짐
- code, data는 정적 할당
- heap, stack은 동적 할당
- code
    - 사용자가 작성한 프로그램 함수들의 코드
    - CPU는 코드 영역에 저장된 명령어를 하나씩 가져가서 처리
- data
    - 코드가 실행되면서 사용하는 전역변수, static 변수 등이 저장
    - 프로그램 시작과 함께 할당되며 프로그램이 종료되면 소멸
- heap
    - 사용자에 의해 메모리 공간이 동적으로 할당되고 해제
    - 메모리의 낮은 주소에서 높은 주소로 할당
- stack
    - 함수 안에서 선언된 지역 변수, 매개변수, 리턴값 등이 저장
    - 함수의 호출과 함께 동적으로 할당되며 함수의 호출이 완료되면 소멸
    - 메모리의 높은 주소에서 낮은 주소로 할당


운영체제는 프로세스마다 독립적인 메모리 영역을 할당해준다. 그렇기 때문에 프로세스 간 영향을 받지 않고 독립적인 작업을 수행할 수 있다. 프로세스 간 데이터 접근 및 공유가 불가능 하기 때문에 프로세스 간 통신은 IPC 또는 공유메모리 등의 통신 기법을 사용해야한다.
## Thread
프로세스가 운영체제로부터 할당 받은 자원을 이용하는 실행 단위이며, 프로세스는 반드시 하나 이상의 스레드를 갖는다. 프로세스의 code, data, heap 영역을 공유하고 별도의 stack 영역을 할당 받기 때문에 스레드 간 영향을 받지 않고 독립적인 작업을 수행할 수 있다.

프로세스를 "프로그램을 실행하여 프로그램 데이터들이 메모리에 올라와 CPU를 할당받아 명령을 수행하고 있는 상태이다". 라고 설명하였지만. 실제로 CPU를 할당 받아서 개발자가 작성한 코드를 실행시키는 주체는 프로세스가 아니라 스레드이다.

각 프로세스는 데이터를 공유하지 않는 반면에 스레드는 프로세스의 code, data, heap 영역을 공유하기 때문에 여러 스레드가 하나의 자원을 대상으로 쓰기 작업을 하게 된다면 동시성 문제가 발생할 수 있다. 이 점이 프로세스와 스레드의 가장 큰 차이점이다.
## Thread와 CPU의 관계
스레드는 운영체제의 스케줄러에 의해 관리되는 CPU의 최소 실행 단위이다. 스케줄러의 알고리즘에 따라 프로세스에 속한 한개의 스레드가 선점되어 CPU에 할당된다. 스레드 간 선점이 일어날 때 CPU의 실행 문맥이 전환되는 컨텍스트 스위칭이 발생한다.

스레드는 프로세의 메모리 영역을 공유하기 때문에 스레드 간 컨텍스트 스위칭은 비용이 적다. 하지만 프로세스 간 컨텍스트 스위칭은 레지스터, 캐시 메모리 등의 초기화 작업이 필요하기 때문에 스레드보다 컨텍스트 스위칭 비용이 더 많이 발생한다.
❗️레지스터는 현재 실행중인 명령어나 데이터가 저장되는 CPU Core 내부에 존재하는 저장 공간이다. 캐시 메모리의 종류는 L1, L2, L3가 있다. L1은 CPU Core 내부에 존재하고 L2, L3는 CPU Core 외부에 존재한다.
